# Проект 8. Возьмёте Бэтмобиль? 
## Юнит 9. NLP/Computer Vision 
### skillfactory_rds  
![https://img.shields.io/badge/Python-3.7.4-blue](https://img.shields.io/badge/Python-3.7.4-blue)

## Оглавление  
[1. Описание модуля](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/module_9/README.md#Описание-модуля)  
[2. Какой кейс решаем?](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/module_9/README.md#Какой-кейс-решаем)  
[3. Этапы работы над проектом](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/module_9/README.md#Этапы-работы-над-проектом)  
[4. Результат](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/module_9/README.md#Результат) 

### Описание модуля  
Данный проект является продолжением проекта по предсказанию стоимости автомобилей.
Теперь кроме табличных данных мы можем обогатить датасет текстовыми данными и фотографиями автомобилей из объявлений о продаже, свести все наши модели в единое решение — Multi-inputs сеть для улучшения работы модели.

***Чем мы будем заниматься?***  
- Построим «наивную» ML-модель на табличных данных, которая предсказывает цену по модели и году выпуска, что позволит нам задать направление для дальнейших экспериментов. 
- Обработаем и отнормируем признаки и сделаем первую модель на основе градиентного бустинга с помощью CatBoost.
- Решим эту же задачу с помощью DL, применив сверточные нейронные сети для работы с табличными данными (модель NN Tabular) и сравним результаты.
- Добавим текстовые данные (NLP) и сделаем Multi-Input нейронную сеть для анализа и табличных данных, и текста одновременно.
- Добавим обработку изображений в Multi-Input нейронную сеть.
- Осуществим ансамблирование градиентного бустинга и нейронной сети (усредним их предсказания).
:arrow_up:[к оглавлению](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/module_9/README.md#Оглавление)

### Какой кейс решаем?
Необходимо пройдети по всему циклу разработки комплексной Multi-Inputs модели (от обработки данных до внедрения в продакшн).
В качестве данных в работе над проектом предусмотрено три файла: архивы train.zip и test.zip и img с фотографиями автомобилей.

**Метрика качества**
Победитель определяется по наименьшему значению MAPPE.
:arrow_up:[к оглавлению](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/module_9/README.md#Оглавление)

### Этапы работы над проектом  
1. Анализ датасета EDA.
Проведённый разведовательный анализ позволил подробно ознакомиться с датасетом и понять, как лучше обрабатывать данные для подачи на входы Multi-Input нейронной сети.
Произведена очистка датасета от дубликатов, пропущенных значений, выполнена нормализация и стандартизация признаков, применены методы для кодирования категориальных признаков.
При извлечении числовых значений из текста сделан парсинг признаков 'engineDisplacement', 'enginePower', 'Владение'. 
Выполнено сокращение размерности категориальных признаков, произведена генерация новых признаков, что позволило улучшить показатели MAPE на всех сетях.

2. Построение модели по обработке естественного языка (NLP).
Сделана чистка текста из описаний объявлений с помощью дополненного СТОП-списка.
Разработан вариант выделения из описаний часто встречающихся блоков текста, слов, с дальнейшей фильтрацией по нему.
Применены дополнительные методы предобработки текста (токенизация, лемматизация) с использованием библиотек ntlk и pymorphy2, построена LSTM сеть для обработки текста. 

3. Добавление изображений в решение.
В качестве базовой модели использована SOTA архитектура сети EfficientNetB4 и применялись дополнительные методы предобработки изображений (аугментация).
В процессе обучения модели осуществлен подбор LR, optimizer, loss, количества эпох для обучения, в том числе, использовались другие функции callback в Keras (ModelCheckpoint с сохранением модели в случае улучшения значения val_accuracy, ReduceLROnPlateau с динамическим изменением скорости обучения модели, в случае прекращения снижения val_loss). 

4. Оценка модели и интерпретация результатов.
Произведён анализ результатов работы построенных моделей, в том числе с использованием техники blend, позволяющей усреднять результаты сетей, добиваясь лучшего результата.
Лучший результат получен для нейросети на основе табличных данных и у модели, полученной при помощи LightAutoML, а также их блендов.
:arrow_up:[к оглавлению](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/module_9/README.md#Оглавление)

### Результат  
- MAPE = 10.95817% 
- 6 место из 45 участников  
:arrow_up:[к оглавлению](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/module_9/README.md#Оглавление)