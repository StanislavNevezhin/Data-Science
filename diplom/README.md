# Дипломный проект
## Создание модели машинного обучения для предупреждения прихватов при бурении скважин 
### skillfactory_rds  
![https://img.shields.io/badge/Python-3.7.4-blue](https://img.shields.io/badge/Python-3.7.4-blue)

## Оглавление  
[1. Описание модуля](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/diplom/README.md#Описание-модуля)  
[2. Какой кейс решаем?](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/diplom/README.md#Какой-кейс-решаем)  
[3. Этапы работы над проектом](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/diplom/README.md#Этапы-работы-над-проектом)  
[4. Результат](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/diplom/README.md#Результат) 

### Описание модуля  
Данный проект является выпускной работой.

***Чем мы будем заниматься?***  
Дано: исторические данные с датчиков буровой установки по 21 технологическому параметру для 178 прихватов.
 
Требуется: построить модель-классификатор на исторических данных, выявляющую по показателям с датчиков буровой установки  моменты времени в которые ожидается (отметка 1) или не ожидается (отметка 0) прихват.

Ограничения: модель должна быть интерпретируемой, поэтому требуется использовать машинное обучение, а не нейронные сети.
:arrow_up:[к оглавлению](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/diplom/README.md#Оглавление)

### Какой кейс решаем?
Прихватом называется увеличенное по сравнению с расчетным сопротивление движению инструментов в скважине.

Предотвращение прихватов позволяет экономить до 10% стоимости бурения скважины, стоимость же устранения одного прихвата равна $20 000…30 000.

Если персонал будет знать о моменте наступления прихвата, то это позволит изменить параметры бурения.
:arrow_up:[к оглавлению](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/diplom/README.md#Оглавление)

### Этапы работы над проектом  
1. Разведывательный анализ данных.
В ходе разведывательного анализа данные с датчиков буровой установки для 178 аварий объединены в один файл, сформирована обучающая (первые 121 аварий) и тестовая выборка (последующие 57 аварий). Осуществлено заполнение пропущенных значений, приведение значений к заданным единицам измерения.

Выявлены значимые переменные для обучения модели (BPOS, HKLD, STOR, FLWI, RPM, SPPA), при помощи Tsfresh сгенерированы дополнительные признаки (787 признаков). Из полученного множества признаков выделен набор релевантных признаков (205 признаков).

2. Построение и тестирование моделей.
Выбраны критерии качества при оценке моделей-кандидатов: количество верно распознанных 0 (отсутствие прихвата) и 1 (возникновение прихвата) согласно Confusion Matrix. Протестированы <10 моделей, наилучшие результаты получены для модели LightAutoML, обученной на наборе релевантных признаков.

3. Проверка работы выбранной модели.
Осуществлена проверка работы выбранной модели на исторических данных для одного дня, в ходе которой распознали все размеченные Заказчиком прихваты, из 241 ложных прихватов выявили те, которые действительно происходили, но не были размечены Заказчиком. 

4. Вывод модели в Production.
На основе Flask и Ngrok разработан сервис, позволяющий пользователю в рамках ноутбука Google Colab загружать обученую модель с Google Drive, загружать файл с историческими данными и выгружать на локальный компьютер пользователя файл, содержащий результаты работы модели.
:arrow_up:[к оглавлению](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/diplom/README.md#Оглавление)

### Результат  
При помощи новой переменной  RUL (Remain useful life) – остаточного срока службы до прихвата, решена задача регрессии и предупреждения прихвата при бурении скважин за 2-5 минут до его возникновения.
:arrow_up:[к оглавлению](https://github.com/StanislavNevezhin/skillfactory_rds/tree/master/diplom/README.md#Оглавление)